import matplotlib as mpl
mpl.use('Agg')
import matplotlib.pyplot as plt
mpl.rcParams['figure.figsize'] = (7,7)

def plot_learning_curves(x_axis_label, y_axis_label, x_axis, y_axis_1, y_axis_2, type):
    plt.plot(x_axis, y_axis_1, marker='*')
    plt.plot(x_axis, y_axis_2, marker='*')
    plt.legend(['Train', 'Test'], loc='best')
    plt.xlabel(x_axis_label)
    plt.ylabel(y_axis_label)
    plt.title(y_axis_label + ' v/s ' + x_axis_label)
    plt.savefig(type,dpi=300)


def main():
    sgd_train = [1.266316886,
            0.917590402,
            0.876413077,
            0.858193166,
            0.846967459,
            0.838136199,
            0.829162085,
            0.817717714,
            0.801219392,
            0.777722275,
            0.747898504,
            0.714602001,
            0.679724532,
            0.643759865,
            0.607110786,
            0.570434468,
            0.534498465,
            0.500037647,
            0.467639768,
            0.437680162]
    sgd_test = [
        1.275549676,
        1.018326644,
        0.979125252,
        0.962032323,
        0.952652219,
        0.946987775,
        0.942987332,
        0.939555989,
        0.93579011,
        0.930903678,
        0.92483121,
        0.918564417,
        0.912753807,
        0.907878289,
        0.904259613,
        0.901972511,
        0.90125616,
        0.902186918,
        0.904688704,
        0.908642818
        ]

    asymmetric_svd_train = [1.140792516,0.87411333,0.838456261,0.820580787,
            0.801239206,
            0.784510945,
            0.769637607,
            0.755810139,
            0.74327157,
            0.731614738,
            0.720366129,
            0.709235076,
            0.698279405,
            0.687653314,
            0.677295367,
            0.667309327,
            0.657529702,
            0.647804473,
            0.63831969,
            0.628979064,
            0.619810817,
            0.610808455,
            0.602194917,
            0.599967819,
            0.581424084,
            0.595175697,
            0.567733714,
            0.569835573,
            0.545746912,
            0.536304637,
            0.527559936,
            0.518357916,
            0.511424417,
            0.503964634,
            0.490296477,
            0.482146007,
            0.474915389,
            0.467537455,
            0.460367752,
            0.454489412]

    asymmetric_svd_test = [1.190391004,
0.991403896,
0.956927099,
0.939250553,
0.923809621,
0.912960272,
0.905137966,
0.899672327,
0.895948097,
0.893407541,
0.891689972,
0.890362221,
0.889517365,
0.888948917,
0.888443613,
0.888235199,
0.88827621,
0.888057508,
0.887894956,
0.888017418,
0.88802224,
0.888412183,
0.88889023,
0.894050899,
0.893878808,
0.905892105,
0.898079534,
0.907603264,
0.900264098,
0.902044112,
0.905336268,
0.908276768,
0.913088249,
0.916747639,
0.912947479,
0.913102027,
0.915375447,
0.917931655,
0.921576006,
0.925250881
    ]
    svdplus_train = [1.140685063,
0.870329813,
0.832675952,
0.809227511,
0.780173466,
0.751719627,
0.723319716,
0.694074093,
0.663722179,
0.632758976,
0.601569216,
0.569970809,
0.537798978,
0.505327289,
0.473346546,
0.442753559,
0.414158203,
0.387987327,
0.364211713]

    svdplus_test = [1.191993805,
0.989689468,
0.957970604,
0.940506552,
0.922591953,
0.90997403,
0.901250659,
0.894776589,
0.88999836,
0.886590977,
0.8843105,
0.883171455,
0.883927779,
0.885880835,
0.889313974,
0.894542118,
0.90103056,
0.908502345,
0.917219896]
    iterations = [10,20,30,40,50,60,70,80,90,100,110,120,130,140,150,160,170,180,190]
    # iterations = [10,20,30,40,50,60,70,80,90,100,110,120,130,140,150,160,170,180,190,200,210,220,230,240,250,260
    #                 ,270,280,290,300,310,320,330,340,350,360,370,380,390,400]
    plot_learning_curves('Iterations', 'Mean Squared Error', iterations, svdplus_train, svdplus_test, type='SVD++')



if __name__ == '__main__':
    main()